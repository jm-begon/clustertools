#!/usr/bin/env python
"""
This litte program is made to evolve the ct_folder from 0.0.1 to 0.0.2
"""
__author__ = "Begon Jean-Michel <jm.begon@gmail.com>"
__copyright__ = "3-clause BSD License"

import shutil
import os
import glob
from clustertools.deprecated import get_ct_folder0_0_1

def mkdir(base, middle, suffix=""):
    path = os.path.join(base, middle)
    if suffix != "":
        path = os.path.join(path, suffix)
    if not os.path.exists(path):
        os.makedirs(path)
    return path

if __name__ == '__main__':
    # TODO add safety, nicefy
    ct_folder = get_ct_folder0_0_1()
    db_folder = os.path.join(ct_folder, "databases")
    for item in os.listdir(db_folder):
        if item.startswith("result_"):
            fname = item[7:]
            exp_name, extension = os.path.splitext(fname)
            folder_ = mkdir(ct_folder, "exp_%s"%exp_name)
            shutil.move(os.path.join(db_folder, item),
                        os.path.join(folder_, "results"+extension))
        if item.startswith("notif_"):
            fname = item[6:]
            exp_name, extension = os.path.splitext(fname)
            folder_ = mkdir(ct_folder, "exp_%s"%exp_name)
            shutil.move(os.path.join(db_folder, item),
                        os.path.join(folder_, "notifications"+extension))
    log_folder = os.path.join(ct_folder, "logs")
    for item in os.listdir(log_folder):
        full = os.path.join(log_folder, item)
        if os.path.isdir(full):
            folder_ = mkdir(ct_folder, "exp_%s"%item)
            shutil.move(full, os.path.join(folder_, "logs"))






